---
layout: post
author: Jesus Alvarado
title: Gr치ficas de Docking score con Matplotlib
---

![800x600](https://cdn.activestate.com/wp-content/uploads/2020/03/Top10FinancePackages-1200x675.png)

## Qu칠 es matplotlib?

Matplotlib es una librer칤a de python para la creaci칩n de gr치ficas est치ticas, animadas e interactivas 游녨. Reportes cient칤ficos, art칤culos para journals, gr치ficas para tesis o libros, an치lisis exploratorio de datos, data wrangling para machine learning, entre muchas otras aplicaciones, emplean masivamente este tipo de herramientas. Podemos encontrar tutoriales, ejemplos de aplicaciones, documentaci칩n en https://matplotlib.org/ y bastante material de apoyo en la web.

Aqu칤 veremos como generar una gr치fica de barras para dos casos:

> Una gr치fica informativa sobre un grupo de complejos (compuestos de coordinaci칩n o compuesto metal-ligando org치nico)


> Una gr치fica de barras conteniendo el docking score de estos complejos en una enzima, en su forma nativa y 5 mutantes.

## 1. Reporte de complejos   

Cuando hablamos de complejos o compuestos de coordinaci칩n en soluci칩n, acuosa por ejemplo, nos enfrentamos a un sistema din치mico que puede intercambiar alg칰n o algunos ligandos con su entorno, con mol칠culas de agua. Esta especiaci칩n se va a encontrar intrinsecamente asociada con factores cin칠ticos y termodin치micos. En este trabajo dise침amos 22 estructuras, donde algunos complejos pod칤an contener 1 o m치s intercambios de ligando con agua, mantener ligandos sulfatos o pirazinamida, adem치s de modificar su carga total. 

> El objetivo es resumir el contenido de ligandos en el complejo

`Paso 1` Importar librer칤as

Numpy y Pandas ser치n abordados en un siguiente apartado. En este caso nos enfocaremos unicamente en matplotlib:

```
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
```

> Seg칰n David Zarruk, profesor del curso de anal칤tica predictiva y modelos de regresi칩n en Python, una librer칤a de programaci칩n es un conjunto de funciones que alguien escribi칩 en alguna parte del mundo y ha disponibilizado para que cualquiera pueda utilizarlo de forma gratuita. 

Una librer칤a en Python es un conjunto de implementos funcionales que te ayudar치n a codificar todo este lenguaje de programaci칩n para crear una interfaz independiente. Las librer칤as de Python son amplias y cuentan con gran cantidad de producciones en contenidos. Constan de diversos m칩dulos que permiten el acceso de funcionalidades espec칤ficas del sistema como entrada y salida de archivos, soluciones estandarizadas a problemas de programaci칩n, etc. Adem치s, dependiendo del sistema operativo que tengas, puedes conseguir diferentes funciones de cada una de las librer칤as de Python. Por ejemplo, para el sistema Windows se incluye la biblioteca est치ndar completa junto con componentes adicionales. Un plus para las librer칤as de Python es que cuentan con una colecci칩n de componentes como, por ejemplo, programas individuales, m칩dulos, paquetes, frameworks, aplicaciones y m치s funciones que puedes encontrar en Python Package Index.

`Paso 2` Cargar data

En este caso emplearemos un archivo csv que se encuentra en nuestro drive. Abrimos un nuevo cuaderno de c칩digo (notebook), disponible en https://colab.research.google.com/, lo conectamos a drive y nos dirigimos a la carpeta que contiene el csv:

```
%cd /content/drive/MyDrive/0_3_python/graficas_jm
!ls
```
- Output:

```
/content/drive/MyDrive/0_3_python/graficas_jm
Libro1.csv
```
`Paso 3` Invocamos pandas para visualizar la data

Para que la primera columna sea tomada como 칤ndice se considera index_col 

```
j1 = pd.read_csv('Libro1.csv',index_col='Molecule')
j1.head(3)
```
- Output

Molecule | Total_chrg | PZA_lig	| PZA_lig_at |	Water_lig |	Sulfate
--- | --- | --- | --- | --- | ---
PZA | 0 | 1 |	0 |	0 |	0
FePZA_1 |	2 |	2 |	4 |	2 |	0
FePZA_1i	| 2	| 2	| 4	| 2	| 0

`Paso 4` Identificamos las columnas
```
j1.columns
```
- Output

```
Index(['Total_charge', 'PZA_ligand', 'PZA_ligant_atoms', 'Water_ligand',
       'Sulfate'],
      dtype='object')
```

`Paso 5` Creaci칩n de DataFrame

Para que el contenido de enteros sea tratado como tal, requerimos crear un DataFrame, que estamos guardando en la variable j2 (y nuevamente visualizando su encabezado)

```
j2 = pd.DataFrame(j1, columns = ['Total_charge',
                                 'PZA_ligand','PZA_ligant_atoms',
                                 'Water_ligand', 'Sulfate'],dtype='object')
j2.head(3)
```
```
type(j2['Total_charge'][0])
```
- Output

```
int
```

`Paso 6` Creaci칩n de index

Podemos asignar un 칤ndice en particular, en este caso tomando la salida de j2.columns o j1.columns asignamos la lista de elementos en el 칤ndice a la variable index_1:

```
index_1 = ['PZA','FePZA_1','FePZA_1i','FePZA','FePZAi','FePZA_1SO4','FePZA_1SO4i','FePZA_2SO4','FePZA_2SO4i','FePZA_2SO4-pza','FePZA_2SO4-pzai','FePZA_2SO4-pza2','ZnPZA_1','ZnPZA_1i','ZnPZA','ZnPZAi','ZnPZA_1SO4','ZnPZA_1SO4i','ZnPZA_2SO4','ZnPZA_2SO4i','ZnPZA_2SO4-pza','ZnPZA_2SO4-pzai','ZnPZA_2SO4-pza2']
index_1
```
- Output

```
['PZA',
 'FePZA_1',
 'FePZA_1i',
 'FePZA',
 'FePZAi',
 'FePZA_1SO4',
 'FePZA_1SO4i',
 'FePZA_2SO4',
 'FePZA_2SO4i',
 'FePZA_2SO4-pza',
 'FePZA_2SO4-pzai',
 'FePZA_2SO4-pza2',
 'ZnPZA_1',
 'ZnPZA_1i',
 'ZnPZA',
 'ZnPZAi',
 'ZnPZA_1SO4',
 'ZnPZA_1SO4i',
 'ZnPZA_2SO4',
 'ZnPZA_2SO4i',
 'ZnPZA_2SO4-pza',
 'ZnPZA_2SO4-pzai',
 'ZnPZA_2SO4-pza2']
```

`Paso 7` Gr치fica

Cada una de las columnas van asociadas a una variable, estas luego son indexadas a un nuevo DataFrame df1, indic치ndose adem치s el 칤ndice.

> nombre_dataframe.plot.bar es el comando para generar la gr치fica de barras

Los r칩tulos, por ejemplo del eje X, pueden tener un 치ngulo de rotaci칩n, esto se indica con rot=90, en nuestro caso vertical.
"Figure" y figsize nos permiten modificar la proporci칩n entre horizontal y vertical.

```
#Columnas
Total_charge = list(j2['Total_charge'])
PZA_ligand = list(j2['PZA_ligand'])
PZA_ligant_atoms = list(j2['PZA_ligant_atoms'])
Water_ligand  = list(j2['Water_ligand'])
Sulfate = list(j2['Sulfate'])
#R칩tulos
df1 = pd.DataFrame({'Total_charge':Total_charge,
                    'PZA_ligand':PZA_ligand,
                    'PZA_ligant_atoms':PZA_ligant_atoms,
                    'Water_ligand':Water_ligand,
                    'Sulfate':Sulfate
                    }, 
                   index=index_1)
ax = df1.plot.bar(rot=90)
plt.figure(figsize=(40,5))
plt.show()
```

- Output

![download](https://user-images.githubusercontent.com/25043666/147608282-5ea0ad6d-a0d1-4390-8ab1-6bbaf68a31a3.png)

`Paso 8` Guardar la imagen vectorizada

```
fig = ax.get_figure()
fig.savefig('jes.svg',dpi=600)
```

> La imagen generada se puede guardar en diversos formatos, sin embargo, disponer de la imagen vectorizada es un lujo. Programas como Inkscape (libre) o CorelDraw ($) nos permiten personalizar a칰n m치s la gr치fica, mejorar la resoluci칩n, entre otras cosas.


## 2. Docking score   

`Paso 1` Idem a la parte 1

Teniendo en cuenta que requerimos disponer de las librer칤as, pasamos a importar la data usando pandas.

```
#docking score
ds = pd.read_csv('Libro2.csv',index_col='Molecule')
ds.head(23)
```

`Paso 2` Exploraci칩n de datos & DataFrame

Comandos como "ds.info()" y "ds.columns" nos permitir치n verificar la data importada.

```
ds1 = pd.DataFrame(ds, columns = ['3PL1-WT', 'Mut-ASN49', 
                                  'Mut-ARG51', 'Mut-ARG57', 
                                  'Mut-TYR71', 'Mut-ALA139'],
                   dtype='object')
ds1.head(3)
```

- Output

Molecule | 3PL1-WT | Mut-ASN49 | Mut-ARG51 | Mut-ARG57 | Mut-TYR71 | Mut-ALA139
--- | --- | --- | --- | --- | --- | ---
PZA | -5.723 | -6.475 | -6.434 | -5.905 | -6.244 | -6.432
FePZA_1 | -8.588 | -9.175 | -9.698 | -6.428 | -8.126 | -9.444


`Paso 3` Gr치fica

```
#Columnas
WT = list(ds1['3PL1-WT'])
Mut_ASN49 = list(ds1['Mut-ASN49'])
Mut_ARG51 = list(ds1['Mut-ARG51'])
Mut_TYR71  = list(ds1['Mut-TYR71'])
Mut_ALA139 = list(ds1['Mut-ALA139'])
#R칩tulos
ds2 = pd.DataFrame({'WT':WT,
                    'Mut_ASN49':Mut_ASN49,
                    'Mut_ARG51':Mut_ARG51,
                    'Mut_TYR71':Mut_TYR71,
                    'Mut_ALA139':Mut_ALA139
                    }, 
                   index=index_ds1)
ax = ds2.plot(kind='bar', rot=90, width=0.6)#, linewidth=2.0)
plt.xlabel('pH 6.0', fontsize=12, fontweight='bold')
plt.ylabel('Docking score (kcal/mol)', fontsize=12, fontweight='bold')
#plt.figure(figsize=(5,3))#,dpi=None)
plt.legend(bbox_to_anchor=(0.98, 0.40), loc=1, borderaxespad=0)
plt.show()
```
- Output

![download](https://user-images.githubusercontent.com/25043666/147609283-8adc1295-6bf2-4716-8cf1-c67bb6246144.png)

Idem a la parte 1, podemos guardar la imagen en formato SVG. Una hoja de resumen de comandos b치sicos de Matplotlib pueden ser encontrados en los "cheat sheet"

![800x600](https://blog.finxter.com/wp-content/uploads/2021/01/image-170-1024x724.png)

Im치genes de:
- https://www.activestate.com/blog/top-10-python-packages-for-finance-and-financial-modeling/
- https://blog.finxter.com/wp-content/uploads/2021/01/image-170-1024x724.png
